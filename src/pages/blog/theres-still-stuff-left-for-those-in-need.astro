---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { buttonVariants } from "@/components/ui/button";
import joshuaImage from '../../assets/joshua-ford-family-profile_nw_79fe0e22.jpg';
import { getPostBySlug } from '../../lib/wordpress';
import FreeStuffGallery from "@/components/FreeStuffGallery.astro";
import RequestItemForm from "@/components/RequestItemForm";

// Get the post data
const slug = 'theres-still-stuff-left-for-those-in-need';
let post;
try {
  post = await getPostBySlug(slug);
} catch (error) {
  console.error(`Error fetching post ${slug}:`, error);
  // Fallback post data if API call fails
  post = {
    title: "There's still stuff left for those in need!",
    excerpt: "Sorry it took so long to respond to everyone. I'm writing this next to my wife in the Emergency Room right now. Battling health issues, trying to raise a family and trying to keep things together seems to take more than we have to give on some weeks.",
    content: `<p>Sorry it took so long to respond to everyone. I'm writing this next to my wife in the Emergency Room right now. Battling health issues, trying to raise a family and trying to keep things together seems to take more than we have to give on some weeks. I know we're not alone in this which is one of the reasons we wanted to bless anyone that we could!</p>

<p>We still have some things left and before we donated it to Helping Hands we wanted to allow people to come by again. We need to be out of the space we are using by Monday, so we have Friday and Saturday (October 24th-25th) available for pickups.</p>

<p>We are not posting anything publicly about it. Our last post was seen by over 80,000 people in Ellis county and we had many of you who messaged about items or clothing. So this posting is being sent out to only the people who have already messaged but didn't get to come by which is 50+ of you guys.</p>

<p>We had a lot of people who were looking for clothing but we only have certain sizes. I created a form below to be filled out so we can try to connect people with the things that we have that can help them.</p>

<p>If you guys can fill it out ASAP with what items you were looking for we will get back with you to set up a time to come by this weekend. If we can help you.</p>

<p>I put updated pictures on this post of everything that is still left. Again, everything is free if you are in need.</p>

<p>Please fill out below as soon as you can.</p>

<p>P.S. As much as we would love to be able to help everyone, we cannot do holds or save things for people. We will do our best to get back with you if we think we can match you up with some things.</p>`,
    date: 'October 10, 2025',
    author: 'Joshua Ford',
    authorId: 1,
    authorSlug: 'testingpressable',
    category: 'Free Stuff',
    categoryId: 66,
    categorySlug: 'free-stuff',
    tags: [],
    imageUrl: 'https://blog.thefordfamily.life/wp-content/uploads/2025/10/img_2734.jpg'
  };
}

// Generate the SEO-friendly metadata
const ogImage = new URL(`/og-images/${slug}.png`, Astro.site);
---

<BaseLayout title={post.title} description={post.excerpt} ogImage={ogImage}>
  <div class="bg-muted/20 py-6 border-b border-primary/10">
    <div class="container max-w-4xl mx-auto">
      <div class="flex items-center space-x-2 mb-1">
        <a href="/blog" class="text-primary hover:text-primary-foreground transition-colors">
          Blog
        </a>
        <span class="text-muted-foreground">/</span>
        <a href={`/blog/category/${post.categorySlug}`} class="text-primary hover:text-primary-foreground transition-colors">
          {post.category}
        </a>
      </div>
      
      <h1 class="text-3xl md:text-4xl font-bold font-display mb-3 text-primary-foreground">
        {post.title}
      </h1>
      
      <div class="flex flex-wrap items-center text-sm text-muted-foreground gap-x-4 gap-y-2 mb-4">
        <div class="flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
          <a 
            href={`/blog/author/${post.authorSlug}`}
            class="hover:text-primary transition-colors"
          >
            {post.author}
          </a>
        </div>
        
        <div class="flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          <span>{post.date}</span>
        </div>
        
        <div class="flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1"><path d="m7 20-3-3m0 0 3-3m-3 3h13m3-9-3 3m0 0 3 3m-3-3H7"></path></svg>
          <span>Share</span>
        </div>
      </div>
    </div>
  </div>
  
  <main class="py-12">
    <div class="container mx-auto">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
        <!-- Main Content -->
        <div class="lg:col-span-2">
          <article class="scrapbook-paper bg-white/95 mb-8">
            <!-- Gallery of free stuff images instead of a single image -->
            <FreeStuffGallery />
            
            <!-- Original Facebook post embed -->
            <div class="my-6 flex flex-col items-center">
              <p class="text-sm text-muted-foreground mb-2 italic">Original posting:</p>
              <iframe 
                src="https://www.facebook.com/plugins/post.php?href=https%3A%2F%2Fwww.facebook.com%2Fj.d.ford.313691%2Fposts%2Fpfbid0z86zp2wWR28B7udFkcVsATggjjMFrj7D3H7XFUhCQhKc6G8zd2sp5temEmQXxQdHl&show_text=true&width=500" 
                width="500" 
                height="250" 
                style="border:none;overflow:hidden" 
                scrolling="no" 
                frameborder="0" 
                allowfullscreen="true" 
                allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"
                class="max-w-full"
              ></iframe>
            </div>
            
            <div class="prose prose-slate max-w-none">
              <div set:html={post.content} />
            </div>
            
            <!-- Request Form -->
            <div class="mt-8 pt-6 border-t border-border">
              <h2 class="text-2xl font-bold font-display mb-6 text-center text-primary-foreground">
                Request Free Items
              </h2>
              <RequestItemForm client:load />
            </div>
          </article>
          
          <!-- Author Bio -->
          <div class="scrapbook-paper bg-accent/5">
            <div class="flex flex-col sm:flex-row gap-4 items-center sm:items-start">
              <div class="scrapbook-photo" style="--rotate: -2deg;">
                <div class="scrapbook-tape"></div>
                <img 
                  src={joshuaImage.src}
                  alt={post.author}
                  class="w-20 h-20 object-cover rounded-sm"
                />
              </div>
              <div>
                <h3 class="font-display font-bold text-lg">{post.author}</h3>
                <p class="text-muted-foreground mb-3">
                  Writer & Entrepreneur
                </p>
                <p class="text-sm mb-3">
                  Joshua shares insights on entrepreneurship, inventions, and creative projects through Next Mountain Ventures.
                </p>
                <a href={`/${post.author.split(" ")[0].toLowerCase()}`} class={buttonVariants({ variant: 'outline', size: 'sm' })}>
                  More from {post.author.split(" ")[0]}
                </a>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Sidebar -->
        <div class="space-y-8">
          <div class="scrapbook-paper bg-white/90">
            <h3 class="font-display font-bold text-xl mb-4">Available Items</h3>
            <div class="space-y-2">
              <p class="text-sm">Here's a list of some of the items currently available:</p>
              <ul class="space-y-1 text-sm list-disc list-inside ml-2 text-muted-foreground">
                <li>Clothing (various sizes)</li>
                <li>Shoes</li>
                <li>Kitchenware</li>
                <li>Books</li>
                <li>Toys</li>
                <li>Organizing items</li>
                <li>Home decor</li>
                <li>Blankets</li>
                <li>Bean bags</li>
                <li>Desks</li>
                <li>Bookshelves</li>
                <li>And more!</li>
              </ul>
              
              <div class="mt-4 pt-4 border-t border-border">
                <p class="text-sm italic">
                  "We make a living by what we get, but we make a life by what we give." â€“ Winston Churchill
                </p>
              </div>
            </div>
          </div>
          
          <div class="scrapbook-paper bg-white/90">
            <h3 class="font-display font-bold text-xl mb-4">How It Works</h3>
            <div class="space-y-4">
              <div class="flex items-start gap-3">
                <div class="shrink-0 mt-1 rounded-full bg-primary/10 p-2">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-primary">
                    <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
                  </svg>
                </div>
                <div>
                  <h4 class="font-medium text-sm leading-tight mb-1">
                    Fill out the form
                  </h4>
                  <p class="text-xs text-muted-foreground">Let us know what items you need and provide your contact information.</p>
                </div>
              </div>
              
              <div class="flex items-start gap-3">
                <div class="shrink-0 mt-1 rounded-full bg-primary/10 p-2">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-primary">
                    <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path>
                    <path d="m9 12 2 2 4-4"></path>
                  </svg>
                </div>
                <div>
                  <h4 class="font-medium text-sm leading-tight mb-1">
                    We'll check availability
                  </h4>
                  <p class="text-xs text-muted-foreground">We'll look through our inventory to find items that match your needs.</p>
                </div>
              </div>
              
              <div class="flex items-start gap-3">
                <div class="shrink-0 mt-1 rounded-full bg-primary/10 p-2">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-primary">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                  </svg>
                </div>
                <div>
                  <h4 class="font-medium text-sm leading-tight mb-1">
                    Schedule a pickup time
                  </h4>
                  <p class="text-xs text-muted-foreground">We'll contact you to arrange a convenient time to pick up your items this weekend.</p>
                </div>
              </div>
              
              <div class="flex items-start gap-3">
                <div class="shrink-0 mt-1 rounded-full bg-primary/10 p-2">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-primary">
                    <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
                  </svg>
                </div>
                <div>
                  <h4 class="font-medium text-sm leading-tight mb-1">
                    Items are completely free
                  </h4>
                  <p class="text-xs text-muted-foreground">All items are given freely to those in need, no strings attached.</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="scrapbook-paper bg-secondary/5">
            <h3 class="font-display font-bold text-xl mb-4">Spread the Word</h3>
            <p class="text-sm mb-4">Do you know someone who could benefit from these free items? Please share this information directly with them.</p>
            <button class={buttonVariants({ variant: 'outline', size: 'sm', class: 'w-full' })}>
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                <polyline points="16 6 12 2 8 6"></polyline>
                <line x1="12" y1="2" x2="12" y2="15"></line>
              </svg>
              Share With a Friend
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>
</BaseLayout>

<style>
  /* Additional styles for WordPress content */
  :global(.prose p) {
    margin-bottom: 1rem;
    line-height: 1.6;
  }
  
  :global(.prose ul, .prose ol) {
    margin-left: 1.5rem;
    margin-bottom: 1rem;
  }
  
  :global(.prose li) {
    margin-bottom: 0.5rem;
  }
  
  :global(.prose blockquote) {
    border-left: 4px solid #e2e8f0;
    padding-left: 1rem;
    margin: 1.5rem 0;
    font-style: italic;
  }
</style>

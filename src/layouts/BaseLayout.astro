---
import HeadSEO from "@/components/HeadSEO.astro";
import Footer from "@/components/Footer.astro";
import Header from "@/components/Header.astro";
import "../styles/fonts.css";

interface Props {
  title?: string | undefined;
  description?: string | undefined;
  ogImage?: URL | undefined;
}

const { title, description, ogImage } = Astro.props;
const defaultTitle = "The Ford Family";
const defaultDescription = "Our family blog sharing our journey through faith, health challenges, homeschooling, entrepreneurship, and creativity.";
---

<html lang="en">
  <head>
    <HeadSEO 
      title={title || defaultTitle} 
      description={description || defaultDescription} 
      ogImage={ogImage} 
    />
  </head>
  <body class="bg-background min-h-screen font-sans antialiased">
    <script is:inline>
      // Add scroll animation observer
      document.addEventListener('DOMContentLoaded', () => {
        // For regular animate-on-scroll elements - standard behavior
        const standardObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('animate-visible');
            }
          });
        }, { threshold: 0.1 });

        document.querySelectorAll('.animate-on-scroll').forEach(element => {
          standardObserver.observe(element);
        });
        
        // For hero photos - animate photos based on scroll position
        let lastScrollY = window.scrollY;
        const heroPhotos = document.querySelectorAll('.hero-photo-1, .hero-photo-2, .hero-photo-3, .hero-photo-4');
        
        // Initialize photos with correct initial state
        heroPhotos.forEach((photo, index) => {
          photo.style.transitionDelay = `${index * 0.15}s`;
          // Initially, photos are not animated
          if (window.scrollY < 100) {
            photo.classList.remove('animate-visible');
          }
        });
        
        // Use scroll event for more precise control
        window.addEventListener('scroll', () => {
          const scrollY = window.scrollY;
          const scrollingDown = scrollY > lastScrollY;
          const heroSection = document.querySelector('.hero-section');
          
          if (heroSection) {
            const heroSectionBottom = heroSection.offsetTop + heroSection.offsetHeight;
            
            // When scrolling down and past 100px threshold
            if (scrollingDown && scrollY > 100) {
              heroPhotos.forEach((photo, index) => {
                photo.classList.add('animate-visible');
              });
            } 
            // When scrolling up and near the top
            else if (!scrollingDown && scrollY < 100) {
              heroPhotos.forEach((photo, index) => {
                photo.classList.remove('animate-visible');
              });
            }
          }
          
          lastScrollY = scrollY;
        });
        
        // For family profiles in the Our Family Journey section - animate from sides
        const familyProfileObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('animate-profile-visible');
            }
          });
        }, { threshold: 0.15 });
        
        // Observe each family profile separately with slight delay
        document.querySelectorAll('.family-profile').forEach((element, index) => {
          element.style.transitionDelay = `${index * 0.2}s`;
          familyProfileObserver.observe(element);
        });
      });
    </script>
    <div class="relative flex min-h-screen flex-col">
      <Header />
      <main class="flex-auto">
        <slot />
      </main>
      <!-- DO NOT REMOVE - Necessary for making visual edits via new.website! -->
      <script src="https://api.new.website/static/new-website.js"></script>
      <Footer />
    </div>
  </body>
</html>
